using Client;
using System;
using System.ComponentModel.Composition;
using System.Threading.Tasks;
using System.Windows;

namespace MaterialDesignSkin.Modules
{
    [Export(typeof(ISkinBootStrapper))]
    public class BootStrapper : ISkinBootStrapper
    {
        public async Task InitializeAsync()
        {
            var wpfApp = Application.Current;
            await wpfApp.Dispatcher.InvokeAsync(() =>
            {
                wpfApp.Resources.MergedDictionaries.Add(new ResourceDictionary { Source = new Uri(@"pack://application:,,,/MaterialDesignThemes.Wpf;component/Themes/MaterialDesignTheme.Dark.xaml", UriKind.Absolute) });
                wpfApp.Resources.MergedDictionaries.Add(new ResourceDictionary { Source = new Uri(@"pack://application:,,,/MaterialDesignThemes.Wpf;component/Themes/MaterialDesignTheme.Defaults.xaml", UriKind.Absolute) });
                wpfApp.Resources.MergedDictionaries.Add(new ResourceDictionary { Source = new Uri(@"pack://application:,,,/MaterialDesignColors;component/Themes/Recommended/Primary/MaterialDesignColor.Grey.xaml", UriKind.Absolute) });
                wpfApp.Resources.MergedDictionaries.Add(new ResourceDictionary { Source = new Uri(@"/MaterialDesignSkin;component/Resources/Resources.xaml", UriKind.RelativeOrAbsolute) });
            });
        }
    }
}
