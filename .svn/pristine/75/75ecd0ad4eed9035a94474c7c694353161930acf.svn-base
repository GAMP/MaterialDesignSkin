<UserControl x:Class="MaterialDesignSkin.Views.AppView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:lib="clr-namespace:MaterialDesignSkin"
             xmlns:sharedLib="clr-namespace:SharedLib;assembly=DataInterfaces"
             xmlns:lex="clr-namespace:Localization.Extensions;assembly=DataInterfaces"
             mc:Ignorable="d"
             d:DesignHeight="308.884"
             d:DesignWidth="451.037">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition  Width="0.3*" />
            <ColumnDefinition  Width="*" />
        </Grid.ColumnDefinitions>
        <Grid Grid.Column="0"
              Name="_FILTERS_ROOT"
              DataContext="{Binding Apps}">
            <Grid.Resources>
                <Style TargetType="Expander"
                       BasedOn="{StaticResource {x:Type Expander}}">
                    <Setter Property="Background"
                            Value="Transparent" />
                    <Setter Property="Padding"
                            Value="4" />
                    <Setter Property="Margin"
                            Value="4" />
                </Style>
            </Grid.Resources>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <Grid Grid.Row="0">
                <TextBox FontSize="24"
                         Text="{Binding Filter,UpdateSourceTrigger=PropertyChanged}"
                         materialDesign:HintAssist.IsFloating="False"
                         materialDesign:HintAssist.HintOpacity="0.3"
                         materialDesign:HintAssist.Hint="{lex:LocTextUpper Key=SEARCH}"
                         HorizontalAlignment="Stretch"
                         VerticalAlignment="Stretch" />
                <Button Visibility="{Binding HasFilter,Converter={StaticResource BoolToHiddenConverter}}"
                        VerticalAlignment="Center"
                        HorizontalAlignment="Right"
                        Command="{Binding ResetFilterCommand}"
                        Style="{StaticResource MaterialDesignRaisedDarkButton}">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Foreground="Red"
                                   Style="{StaticResource MaterialDesignBody2TextBlock}"
                                   Text="{lex:LocTextUpper Key=SEARCH_CLEAR_FILTERS}" />
                        <materialDesign:PackIcon Margin="4 .5 0 0"
                                                 Foreground="Red"
                                                 Kind="Close" />
                    </StackPanel>
                </Button>
            </Grid>
            <TreeView Grid.Row="1"
                      ItemsSource="{Binding CategoryFilter.ItemsView}"
                      Padding="0"
                      Margin="0,1,0,1"
                      ScrollViewer.VerticalScrollBarVisibility="Hidden"
                      SelectedItemChanged="OnSelectedItemChanged"
                      Name="_CATEGORY_TREE">
                <TreeView.ItemsPanel>
                    <ItemsPanelTemplate>
                        <VirtualizingStackPanel Orientation="Vertical"
                                                IsItemsHost="True" />
                    </ItemsPanelTemplate>
                </TreeView.ItemsPanel>
                <TreeView.ItemContainerStyle>
                    <Style TargetType="TreeViewItem"
                           BasedOn="{StaticResource {x:Type TreeViewItem}}">
                        <Setter Property="IsSelected"
                                Value="{Binding IsSelected}" />
                        <Setter Property="IsExpanded"
                                Value="{Binding IsExpanded}" />
                    </Style>
                </TreeView.ItemContainerStyle>
                <TreeView.ItemTemplate>
                    <HierarchicalDataTemplate ItemsSource="{Binding ItemsView}">
                        <TextBlock FontWeight="SemiBold"
                                   Text="{Binding Name,Converter={StaticResource ToUpperConverter}}"
                                   Style="{StaticResource MaterialDesignSubheadingTextBlock}"
                                   VerticalAlignment="Center"
                                   HorizontalAlignment="Left" />
                    </HierarchicalDataTemplate>
                </TreeView.ItemTemplate>
            </TreeView>
            <Expander Grid.Row="2"
                      IsExpanded="True">
                <Expander.HeaderTemplate>
                    <DataTemplate>
                        <StackPanel>
                            <TextBlock Text="{lex:LocTextUpper Key=FILTER_ACCES}"
                                       Style="{StaticResource MaterialDesignTitleTextBlock}"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Left" />
                        </StackPanel>
                    </DataTemplate>
                </Expander.HeaderTemplate>
                <StackPanel>
                    <CheckBox Content="{lex:LocText Key=FILTER_ANY}"
                              IsEnabled="{Binding AccessType,Converter={StaticResource EmumValueGreaterOrEqualConverter},ConverterParameter=1}"
                              IsChecked="{Binding AccessType,Converter={StaticResource EnumMatchToBooleanConverter},ConverterParameter=DefaultMode}" />
                    <CheckBox Content="FREE TO PLAY"
                              IsChecked="{Binding AccessType,Converter={StaticResource FlagsEnumValueConverter},ConverterParameter={x:Static sharedLib:ApplicationModes.FreeToPlay}}" />
                    <CheckBox Content="REQUIRES SUBSCRIPTION"
                              IsChecked="{Binding AccessType,Converter={StaticResource FlagsEnumValueConverter},ConverterParameter={x:Static sharedLib:ApplicationModes.RequiresSubscription}}" />
                    <CheckBox Content="FREE TRIAL"
                              IsChecked="{Binding AccessType,Converter={StaticResource FlagsEnumValueConverter},ConverterParameter={x:Static sharedLib:ApplicationModes.FreeTrial}}" />
                    <CheckBox Content="ONE TIME PURCHASE"
                              IsChecked="{Binding AccessType,Converter={StaticResource FlagsEnumValueConverter},ConverterParameter={x:Static sharedLib:ApplicationModes.OneTimePurchase}}" />
                </StackPanel>
            </Expander>
            <Expander Grid.Row="3">
                <Expander.HeaderTemplate>
                    <DataTemplate>
                        <StackPanel>
                            <TextBlock Text="{lex:LocTextUpper Key=FILTER_RATING}"
                                       Style="{StaticResource MaterialDesignTitleTextBlock}"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Left" />
                        </StackPanel>
                    </DataTemplate>
                </Expander.HeaderTemplate>
                <StackPanel Orientation="Vertical">
                    <CheckBox Content="{lex:LocText Key=FILTER_ANY}"
                              IsEnabled="{Binding RatingFilter,Converter={StaticResource EmumValueGreaterOrEqualConverter},ConverterParameter=1}"
                              IsChecked="{Binding RatingFilter,Converter={StaticResource EnumMatchToBooleanConverter},ConverterParameter=Any}" />
                    <RadioButton Content="Any"
                                 Visibility="Collapsed"
                                 IsChecked="{Binding RatingFilter,Converter={StaticResource EnumMatchToBooleanConverter},ConverterParameter=Any}" />
                    <RadioButton Content="1+"
                                 IsChecked="{Binding RatingFilter,Converter={StaticResource EnumMatchToBooleanConverter},ConverterParameter=Plus1}" />
                    <RadioButton Content="2+"
                                 IsChecked="{Binding RatingFilter,Converter={StaticResource EnumMatchToBooleanConverter},ConverterParameter=Plus2}" />
                    <RadioButton Content="3+"
                                 IsChecked="{Binding RatingFilter,Converter={StaticResource EnumMatchToBooleanConverter},ConverterParameter=Plus3}" />
                    <RadioButton Content="4+"
                                 IsChecked="{Binding RatingFilter,Converter={StaticResource EnumMatchToBooleanConverter},ConverterParameter=Plus4}" />
                    <RadioButton Content="5"
                                 IsChecked="{Binding RatingFilter,Converter={StaticResource EnumMatchToBooleanConverter},ConverterParameter=Five}" />
                    <RadioButton Content="Unrated"
                                 IsChecked="{Binding RatingFilter,Converter={StaticResource EnumMatchToBooleanConverter},ConverterParameter=Unrated}" />
                </StackPanel>
            </Expander>
            <Expander Grid.Row="4">
                <Expander.HeaderTemplate>
                    <DataTemplate>
                        <StackPanel>
                            <TextBlock Text="TYPE"
                                       Style="{StaticResource MaterialDesignTitleTextBlock}"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Left" />
                        </StackPanel>
                    </DataTemplate>
                </Expander.HeaderTemplate>
                <StackPanel Orientation="Vertical">
                    <CheckBox Content="{lex:LocText Key=FILTER_ANY}"
                              IsEnabled="{Binding Type,Converter={StaticResource EmumValueGreaterOrEqualConverter},ConverterParameter=1}"
                              IsChecked="{Binding Type,Converter={StaticResource EnumMatchToBooleanConverter},ConverterParameter=DefaultMode}" />
                    <CheckBox Content="Game"
                              IsChecked="{Binding Type,Converter={StaticResource FlagsEnumValueConverter},ConverterParameter={x:Static sharedLib:ApplicationModes.Game}}" />
                    <CheckBox Content="Application"
                              IsChecked="{Binding Type,Converter={StaticResource FlagsEnumValueConverter},ConverterParameter={x:Static sharedLib:ApplicationModes.Application}}" />
                    <CheckBox Content="Settings"
                              IsChecked="{Binding Type,Converter={StaticResource FlagsEnumValueConverter},ConverterParameter={x:Static sharedLib:ApplicationModes.Settings}}" />
                    <CheckBox Content="Utility"
                              IsChecked="{Binding Type,Converter={StaticResource FlagsEnumValueConverter},ConverterParameter={x:Static sharedLib:ApplicationModes.Utility}}" />
                </StackPanel>
            </Expander>
            <Expander Grid.Row="5">
                <Expander.HeaderTemplate>
                    <DataTemplate>
                        <StackPanel>
                            <TextBlock Text="PLAYER MODE"
                                       Style="{StaticResource MaterialDesignTitleTextBlock}"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Left" />
                        </StackPanel>
                    </DataTemplate>
                </Expander.HeaderTemplate>
                <StackPanel>
                    <CheckBox Content="{lex:LocText Key=FILTER_ANY}"
                              IsEnabled="{Binding PlayerMode,Converter={StaticResource EmumValueGreaterOrEqualConverter},ConverterParameter=1}"
                              IsChecked="{Binding PlayerMode,Converter={StaticResource EnumMatchToBooleanConverter},ConverterParameter=DefaultMode}" />
                    <CheckBox Content="Single Player"
                              IsChecked="{Binding PlayerMode,Converter={StaticResource FlagsEnumValueConverter},ConverterParameter={x:Static sharedLib:ApplicationModes.SinglePlayer}}" />
                    <CheckBox Content="Lan Multiplayer"
                              IsChecked="{Binding PlayerMode,Converter={StaticResource FlagsEnumValueConverter},ConverterParameter={x:Static sharedLib:ApplicationModes.Multiplayer}}" />
                    <CheckBox Content="Online MultiPlayer"
                              IsChecked="{Binding PlayerMode,Converter={StaticResource FlagsEnumValueConverter},ConverterParameter={x:Static sharedLib:ApplicationModes.Online}}" />
                    <CheckBox Content="Co-Op Lan"
                              IsChecked="{Binding PlayerMode,Converter={StaticResource FlagsEnumValueConverter},ConverterParameter={x:Static sharedLib:ApplicationModes.CoOpLan}}" />
                    <CheckBox Content="Co-Op Online"
                              IsChecked="{Binding PlayerMode,Converter={StaticResource FlagsEnumValueConverter},ConverterParameter={x:Static sharedLib:ApplicationModes.CoOpOnline}}" />
                    <CheckBox Content="Split Screen"
                              IsChecked="{Binding PlayerMode,Converter={StaticResource FlagsEnumValueConverter},ConverterParameter={x:Static sharedLib:ApplicationModes.SplitScreenMultiPlayer}}" />
                </StackPanel>
            </Expander>
        </Grid>
        <Grid Grid.Column="1"
              DataContext="{Binding Apps}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <materialDesign:PopupBox Grid.Column="1" VerticalAlignment="Top">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <TextBlock Margin="4"
                               Style="{StaticResource MaterialDesignTitleTextBlock}"
                               Text="{lex:LocTextUpper Key=SORT_BY}" />
                    <StackPanel Margin="8"
                                Grid.Row="1"
                                Orientation="Vertical">
                        <RadioButton Content="{lex:LocTextUpper Key=APP_SORT_TITLE}"
                                     FontWeight="SemiBold"
                                     IsChecked="{Binding AppSort,Converter={StaticResource EnumMatchToBooleanConverter},ConverterParameter=Title}" />
                        <RadioButton Content="{lex:LocTextUpper Key=APP_SORT_USE}"
                                     FontWeight="SemiBold"
                                     IsChecked="{Binding AppSort,Converter={StaticResource EnumMatchToBooleanConverter},ConverterParameter=Use}" />
                        <RadioButton Content="{lex:LocTextUpper Key=APP_SORT_RATING}"
                                     FontWeight="SemiBold"
                                     IsChecked="{Binding AppSort,Converter={StaticResource EnumMatchToBooleanConverter},ConverterParameter=Rating}" />
                        <RadioButton Content="{lex:LocTextUpper Key=APP_SORT_ADD_DATE}"
                                     FontWeight="SemiBold"
                                     IsChecked="{Binding AppSort,Converter={StaticResource EnumMatchToBooleanConverter},ConverterParameter=DateAdded}" />
                        <RadioButton Content="{lex:LocTextUpper Key=APP_SORT_RELEASE_DATE}"
                                     FontWeight="SemiBold"
                                     IsChecked="{Binding AppSort,Converter={StaticResource EnumMatchToBooleanConverter},ConverterParameter=ReleaseDate}" />
                    </StackPanel>
                </Grid>
            </materialDesign:PopupBox>
            <ItemsControl Grid.Column="0"
                          ItemsSource="{Binding ItemsView,IsAsync=True}"
                          Padding="0"
                          Margin="0"
                          Name="_LIST_PRESENTER"
                          VerticalAlignment="Top"
                          HorizontalAlignment="Stretch"
                          ScrollViewer.VerticalScrollBarVisibility="Disabled"
                          ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                          ItemTemplate="{StaticResource _APP_DISPLAY_LIST_TEMPLATE}">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <lib:VirtualizingWrapPanel ScrollOffset="220"
                                                   VirtualizingPanel.VirtualizationMode="Recycling"
                                                   ChildHeight="420"
                                                   ChildWidth="225"
                                                   IsItemsHost="True" />
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <!--<ItemsControl.Style>
                    <Style TargetType="ItemsControl"
                           BasedOn="{StaticResource {x:Type ItemsControl}}">
                        <Style.Triggers>
                            <Trigger Property="ItemsControl.HasItems"
                                     Value="True">
                                <Setter Property="Visibility"
                                        Value="Visible" />
                                <Setter Property="ScrollViewer.VerticalScrollBarVisibility"
                                        Value="Auto" />
                                <Setter Property="ScrollViewer.CanContentScroll"
                                        Value="True" />
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </ItemsControl.Style>-->
            </ItemsControl>
            <Grid Name="EMPTY_GRID"
                  Grid.Column="0">
                <Grid.Style>
                    <Style TargetType="Grid">
                        <Setter Property="Visibility"
                                Value="Collapsed" />
                        <Style.Triggers>
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding HasFilter}"
                                               Value="True" />
                                    <Condition Binding="{Binding ItemsView.Count}"
                                               Value="0" />
                                </MultiDataTrigger.Conditions>
                                <Setter Property="Visibility"
                                        Value="Visible" />
                            </MultiDataTrigger>
                        </Style.Triggers>
                    </Style>
                </Grid.Style>
                <Grid VerticalAlignment="Center"
                      HorizontalAlignment="Center">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <materialDesign:PackIcon VerticalAlignment="Center"
                                             HorizontalAlignment="Center"
                                             Margin="8"
                                             Width="128"
                                             Opacity="0.5"
                                             Height="128"
                                             Grid.Row="0"
                                             Kind="EmoticonSad" />
                    <TextBlock Grid.Row="1"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Center"
                               IsEnabled="False"
                               Style="{StaticResource MaterialDesignHeadlineTextBlock}"
                               Text="{lex:LocTextUpper Key=SEARCH_NOTHING_FOUND}" />
                </Grid>
            </Grid>
        </Grid>
    </Grid>
</UserControl>
